<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" >

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Barlow:300,400" rel="stylesheet">
    <link rel="shortcut icon" type="image/png" href="/fav.png">

    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/css/fontawesome-all.min.css">
    <script src="/js/main.js"></script>

    <!-- Begin Jekyll SEO tag v2.1.0 -->
<title>TUTORIALS - SophiaTX Developers</title>
<meta property="og:title" content="TUTORIALS" />
<meta name="description" content="SophiaTX Developers Documentation" />
<meta property="og:description" content="SophiaTX Developers Documentation" />
<link rel="canonical" href="https://developers.sophiatx.com/tutorials/" />
<meta property="og:url" content="https://developers.sophiatx.com/tutorials/" />
<meta property="og:site_name" content="SophiaTX Developers" />
<script type="application/ld+json">
{"@context": "http://schema.org",
"@type": "WebPage",
"headline": "TUTORIALS",
"description": "SophiaTX Developers Documentation",
"url": "https://developers.sophiatx.com/tutorials/"}</script>
<!-- End Jekyll SEO tag -->

</head>
<body>
<header>
    <h1>
        <button type="button" class="open-nav" id="open-nav"></button>
        <a href="/"  class="logo-link"><img src="/images/logo.svg" height="40" alt="SophiaTX Developers logo"></a>
    </h1>

    <form action="/search/" method="get">
        <input type="text" name="q" id="search-input" placeholder="Search">
        <input type="submit" value="Search" style="display: none;">
    </form>

    <div id="sidebar" class="sidebar">
	
	
	
		
    <section class="pnl-main-nav-section main-nav-section" url="/">
		<h6 class="ctrl-nav-section title">Introduction</h6>
		<ul class="cont-nav-section content">
			
				
					
					
						
						<li><a href="/#introduction-welcome">Welcome to SophiaTX</a></li>
						
					
						
						<li><a href="/#introduction-chain-basics">Chain Basics</a></li>
						
					
						
						<li><a href="/#introduction-transactions">Transactions</a></li>
						
					
						
						<li><a href="/#introduction-governance">Governance</a></li>
						
					
				
			
		</ul>
	</section>
	
		
    <section class="pnl-main-nav-section main-nav-section" url="/quickstart/">
		<h6 class="ctrl-nav-section title">Quickstart</h6>
		<ul class="cont-nav-section content">
			
				
					
					
						
						<li><a href="/quickstart/#quickstart-choose-sdk">Choose SDK</a></li>
						
					
						
						<li><a href="/quickstart/#quickstart-sophiatx-nodes">SophiaTX Nodes</a></li>
						
					
						
						<li><a href="/quickstart/#quickstart-testnet">SophiaTX testnet</a></li>
						
					
				
			
		</ul>
	</section>
	
		
    <section class="pnl-main-nav-section main-nav-section" url="/tutorials/">
		<h6 class="ctrl-nav-section title">Tutorials</h6>
		<ul class="cont-nav-section content">
			
				
					
					
						
						<li><a href="/tutorials/#tutorials-guide-to-become-witness">How to become witness</a></li>
						
					
						
						<li><a href="/tutorials/#tutorials-guide-to-start-sync-node">How to start sync node</a></li>
						
					
						
						<li><a href="/tutorials/#tutorials-multiparty-encryption">Multiparty Encryption</a></li>
						
					
						
						<li><a href="/tutorials/#tutorials-subscription-api-quick-guide">Subscription API guide</a></li>
						
					
						
						<li><a href="/tutorials/#tutorials-using-sophiatx-to-send-hello-world-msg-via-api">Hello World via API calls</a></li>
						
					
						
						<li><a href="/tutorials/#tutorials-using-sophiatx-to-send-hello-world-msg">Hello World on SophiaTX</a></li>
						
					
						
						<li><a href="/tutorials/#tutorials-guide-automatic-deploy">Node Deploy script</a></li>
						
					
						
						<li><a href="/tutorials/#tutorials-guide-custom-plugins">Custom plugins</a></li>
						
					
				
			
		</ul>
	</section>
	
		
    <section class="pnl-main-nav-section main-nav-section" url="/sdks/">
		<h6 class="ctrl-nav-section title">SDK'S</h6>
		<ul class="cont-nav-section content">
			
				
					
					
						
						<li><a href="/sdks/#sdks-dotnet">C# SDK</a></li>
						
					
						
						<li><a href="/sdks/#sdks-javascript">Javascript SDK</a></li>
						
					
				
			
		</ul>
	</section>
	
		
    <section class="pnl-main-nav-section main-nav-section" url="/apidefinitions/">
		<h6 class="ctrl-nav-section title">Appbase API</h6>
		<ul class="cont-nav-section content">
			
				
					
					
						
						<li><a href="/apidefinitions/#apidefinitions-introduction">Introduction</a></li>
						
					
						
						<li><a href="/apidefinitions/#apidefinitions-alexandria-api">Alexandria Api</a></li>
						
					
						
						<li><a href="/apidefinitions/#apidefinitions-database-api">Database Api</a></li>
						
					
						
						<li><a href="/apidefinitions/#apidefinitions-jsonrpc">Jsonrpc</a></li>
						
					
						
						<li><a href="/apidefinitions/#apidefinitions-network-broadcast-api">Network Broadcast Api</a></li>
						
					
						
						<li><a href="/apidefinitions/#apidefinitions-account-history-api">Account History Api</a></li>
						
					
						
						<li><a href="/apidefinitions/#apidefinitions-block-api">Block Api</a></li>
						
					
						
						<li><a href="/apidefinitions/#apidefinitions-chain-api">Chain Api</a></li>
						
					
						
						<li><a href="/apidefinitions/#apidefinitions-custom-api">Custom Api</a></li>
						
					
						
						<li><a href="/apidefinitions/#apidefinitions-subscribe-api">Subscribe Api</a></li>
						
					
				
			
		</ul>
	</section>
	
		
    <section class="pnl-main-nav-section main-nav-section" url="/cli_wallet/">
		<h6 class="ctrl-nav-section title">Cli Wallet</h6>
		<ul class="cont-nav-section content">
			
				
					
					
						
						<li><a href="/cli_wallet/#cli-wallet-rpc-calls">RPC calls</a></li>
						
					
				
			
		</ul>
	</section>
	
</div>


    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet">
</header>
<div class="main" id="top">
    <div class="hero">
        <h1 class="hero__h1"> TUTORIALS</h1>
        <!--<img class="hero__img" src="/images/hero.png">-->
    </div>
    

	
	
		<section id="tutorials-guide-to-become-witness" class="row tutorials-guide-to-become-witness">
			<h3>
				<a id="tutorials-guide-to-become-witness">
					How to become witness
					
				</a>
			</h3>
			

			<h1 id="setup-witness-node">Setup witness node</h1>
<h3 id="download-wallet-and-node-daemon">Download wallet and node daemon</h3>
<p>Go to https://github.com/SophiaTX/SophiaTX/releases and download latest version.</p>
<h3 id="prepare-node">Prepare node</h3>
<p>Start node for the first time with following command:</p>

<p><code class="highlighter-rouge">./sophiatxd</code></p>

<p>Now go to kill the daemon and go to witness_node_data_dir/ and edit config.ini</p>

<p><code class="highlighter-rouge">cd witness_node_data_dir/</code></p>

<p>And modify this properties:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>plugin = alexandria_api
plugin = network_broadcast_api

webserver-ws-endpoint = 0.0.0.0:9191
</code></pre></div></div>
<p>Now start <code class="highlighter-rouge">cli_wallet</code>, create new wallet file and key for witness</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./cli_wallet
new &gt;&gt;&gt; set_password YOUR_PASSWORD
locked &gt;&gt;&gt; unlock YOUR_PASSWORD
unlocked &gt;&gt;&gt; import_key YOUR_PRIVATE_KEY
unlocked &gt;&gt;&gt; suggest_brain_key
</code></pre></div></div>
<p>Output should look like something like this</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"brain_priv_key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"BLENT EPOCHA GREED OCQUE BHALU TAPE SMUT AVERAH BALAO SHARPEN BUSTARD ATHIRST PACTION WIDBIN NYMPHA BANK"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"wif_priv_key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5J7ejuMu2ZkNWQ367X38wVvBWFzgbsjPvw6PLNtwsYEQrbhigT6"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"pub_key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SPH6m3vR9ZfRiGCSmpdY8G6kaAjXxGYBxu6pRE99cFL95SEcxEWeh"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>
<p>Now kill the daemon and modify config.ini
Now you can reedit config.ini with following properties (you can remove rest of the plugins if you want to be just the witness)</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>plugin = witness

witness = "YOUR_ACCOUNT_NAME"

private-key = 5J7ejuMu2ZkNWQ367X38wVvBWFzgbsjPvw6PLNtwsYEQrbhigT6 (just example)

enable-stale-production = false

required-participation = 35
</code></pre></div></div>
<p>And rerun the daemon with command
<code class="highlighter-rouge">./sophiatxd</code></p>

<p>Now you need to vest tokens to you account and update yourself as witness</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>unlocked &gt;&gt;&gt; transfer_to_vesting YOUR_ACCOUNT_NAME YOUR_ACCOUNT_NAME "250000 SPHTX" true
unlocked &gt;&gt;&gt; update_witness YOUR_ACCOUNT_NAME "YOUR_URL" SPH6m3vR9ZfRiGCSmpdY8G6kaAjXxGYBxu6pRE99cFL95SEcxEWeh {"account_creation_fee":"0.05 SPHTX","maximum_block_size":50331648,"price_feeds":[]} true
</code></pre></div></div>

<h3 id="check-if-your-setup-is-right">Check if your setup is right</h3>
<p>Go to cli_wallet and execute command: <code class="highlighter-rouge">get_witness YOUR_WITNESS_NAME</code> and if you check the output, you should be able to you last confirmed block</p>

<h3 id="setup-price-feeding-service">Setup price feeding service</h3>
<p>Install the price feeder script: <code class="highlighter-rouge">npm install -g sophiatx-price-feeder</code>.</p>

<p>Once done, test it with:</p>

<p><code class="highlighter-rouge">feeder &lt;YOUR_ACCOUNT_NAME&gt; &lt;YOUR_MINING_KEY&gt;</code>, e.g. <code class="highlighter-rouge">feeder &lt;YOUR_ACCOUNT_NAME&gt; 5J7ejuMu2ZkNWQ367X38wVvBWFzgbsjPvw6PLNtwsYEQrbhigT6</code>. Use your actual mining key, as entered into config.ini.</p>

<p>Once the script functionality is checked, run it regularly, at lease once per day. You can use e.g. crond service on Linux:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>crontab
0 * * * * /usr/local/bin/feeder &lt;YOUR_ACCOUNT_NAME&gt; &lt;YOUR_MINING_KEY&gt;
&lt;ctrl-D&gt;
</code></pre></div></div>

<h2 id="setup-ntp-time-synchronization">Setup NTP Time Synchronization</h2>
<h3 id="suse">Suse</h3>
<p><a href="https://www.suse.com/documentation/sles11/book_sle_admin/data/sec_netz_xntp_netconf.html">Suse guide</a></p>
<h3 id="ubuntu">Ubuntu</h3>
<p>Before installing ntpd, you should turn off timesyncd:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo timedatectl set-ntp no
</code></pre></div></div>
<p>Please install ntpd by executing following command:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo apt-get install ntp
</code></pre></div></div>
<p>ntpd will be started automatically after install. You can verify that everything is working by following command:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo ntpq -p
</code></pre></div></div>
<p>Example:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>     remote           refid      st t when poll reach   delay   offset  jitter
==============================================================================
 0.ubuntu.pool.n .POOL.          16 p    -   64    0    0.000    0.000   0.000
 1.ubuntu.pool.n .POOL.          16 p    -   64    0    0.000    0.000   0.000
 2.ubuntu.pool.n .POOL.          16 p    -   64    0    0.000    0.000   0.000
 3.ubuntu.pool.n .POOL.          16 p    -   64    0    0.000    0.000   0.000
 ntp.ubuntu.com  .POOL.          16 p    -   64    0    0.000    0.000   0.000
 ec2-52-17-231-7 193.120.142.71   2 u    -   64    1    0.483   -1.022   0.025
 ec2-52-209-118- 89.101.218.6     2 u    1   64    1    0.679   -1.663   0.267
 tshirt.heanet.i .PPS.            1 u    -   64    1    3.800   -0.999   0.017
 meg.magnet.ie   195.66.241.2     2 u    -   64    1    1.549   -0.667   0.276
 ec2-34-242-217- 89.101.218.6     2 u    -   64    1    0.817    1.451   0.092
 t1.time.ir2.yah 212.82.106.33    2 u    1   64    1    1.666   -0.939   0.005
 mirror.datacent 192.36.144.22    2 u    1   64    1   48.287   -0.197   0.036
 pugot.canonical 17.253.34.125    2 u    -   64    1   11.398   -1.159   0.000
 chilipepper.can 145.238.203.14   2 u    1   64    1   10.779   -1.549   0.000

</code></pre></div></div>


		</section>
	
		<section id="tutorials-guide-to-start-sync-node" class="row tutorials-guide-to-start-sync-node">
			<h3>
				<a id="tutorials-guide-to-start-sync-node">
					How to start sync node
					
				</a>
			</h3>
			

			<h3 id="download-latest-binaries">Download latest binaries</h3>
<p>Go <a href="https://github.com/SophiaTX/SophiaTX/releases">here</a> and download latest binaries.</p>
<h3 id="extract-the-binaries">Extract the binaries</h3>
<p>Please run this command to extract the binaries <code class="highlighter-rouge">tar -xzf BINARY_NAME</code></p>
<h3 id="start-a-node">Start a node</h3>
<p>Please execute following command to run the node <code class="highlighter-rouge">./sophiatxd</code> and kill it (Ctrl + C)</p>
<h3 id="modify-configuration">Modify configuration</h3>
<p>Now you need to modify config.ini file, to have proper full node. Execute following commands:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cd witness_node_data_dir/
nano config.ini
</code></pre></div></div>
<p>And add following configuration to your config.ini</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>plugin = condenser_api
plugin = chain_api
plugin = database_api
plugin = block_api

webserver-ws-endpoint = 0.0.0.0:8090
</code></pre></div></div>
<p>When you finished you can save document with Ctrl+x and then press Y to approve changes.</p>

<h3 id="rerun-the-node">Rerun the node</h3>
<p>Now go back and rerun the node</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cd ..
./sophiatxd
</code></pre></div></div>
<h3 id="check-if-node-is-syncing">Check if node is syncing</h3>
<p>Open new terminal window and run wallet <code class="highlighter-rouge">./cli_wallet</code> when wallet is running set up a password for wallet and execute info command to check if node is syncing.</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>set_password YOUR_PASSWORD
unlock YOUR_PASSWORD
info
</code></pre></div></div>
<p>Output should look like something like this</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"head_block_number"</span><span class="p">:</span><span class="w"> </span><span class="mi">22646</span><span class="p">,</span><span class="w">
  </span><span class="s2">"head_block_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"00005876350c332f4009a37c55fc9147902b8eb1"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-07-26T07:15:36"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"current_witness"</span><span class="p">:</span><span class="w"> </span><span class="s2">"initminer"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"current_supply"</span><span class="p">:</span><span class="w"> </span><span class="s2">"349999999.780000 SPHTX"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"total_vesting_shares"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2250001.000000 VESTS"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"witness_required_vesting"</span><span class="p">:</span><span class="w"> </span><span class="s2">"250000.000000 VESTS"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"maximum_block_size"</span><span class="p">:</span><span class="w"> </span><span class="mi">262144</span><span class="p">,</span><span class="w">
  </span><span class="s2">"current_aslot"</span><span class="p">:</span><span class="w"> </span><span class="mi">24312</span><span class="p">,</span><span class="w">
  </span><span class="s2">"recent_slots_filled"</span><span class="p">:</span><span class="w"> </span><span class="s2">"340282366920938463463374607431768211455"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"participation_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">128</span><span class="p">,</span><span class="w">
  </span><span class="s2">"last_irreversible_block_num"</span><span class="p">:</span><span class="w"> </span><span class="mi">22595</span><span class="p">,</span><span class="w">
  </span><span class="s2">"average_block_size"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="s2">"witness_majority_version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.0.0"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"hardfork_version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1.0.0"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"head_block_age"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2 seconds old"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"participation"</span><span class="p">:</span><span class="w"> </span><span class="s2">"100.00000000000000000"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"median_sbd1_price"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"base"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.000000 SPHTX"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"quote"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.000000 SPHTX"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"median_sbd2_price"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"base"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.000000 SPHTX"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"quote"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.000000 SPHTX"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"median_sbd3_price"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"base"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.000000 SPHTX"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"quote"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.000000 SPHTX"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"median_sbd4_price"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"base"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.000000 SPHTX"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"quote"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.000000 SPHTX"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"median_sbd5_price"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"base"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.000000 SPHTX"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"quote"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.000000 SPHTX"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"account_creation_fee"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.050000 SPHTX"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>
<p>You can rerun this command a few times and see the head_block_age is up to date</p>

<h3 id="setting-up-seednode">Setting up seednode</h3>
<p>If you have followed all steps, now you can create a seednode and be official part of our network. To do that you just need to edit following line in config.ini .</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>p2p-endpoint = 0.0.0.0:60000 
</code></pre></div></div>
<p>Please be sure, that your node is open for p2p traffic.</p>

		</section>
	
		<section id="tutorials-multiparty-encryption" class="row tutorials-multiparty-encryption">
			<h3>
				<a id="tutorials-multiparty-encryption">
					Multiparty Encryption
					
				</a>
			</h3>
			

			<p>Multiparty encryption operates in a closed group of participants, managed by one admin. Multiparty messaging is implemented as an application on top of SophiaTX’s <code class="highlighter-rouge">custom_json_operation</code>.</p>

<h1 id="use-cases">Use cases</h1>

<h2 id="group-creation">Group creation</h2>
<p>Group is created by assigning it a new random name (“group address”), a group key, and individually inviting initial participants to it. The invite is encrypted and readable only to the sender (admin) and recipient (new group member).</p>

<h2 id="group-update">Group update</h2>
<p>Group can be updated any time with new name and/or new group key. Whenever new participants are being added or deleted, the group key must be updated. Group name might be optionally updated. Regular updates of the group will prevent external observers to map group activity, i.e. the potential attacker might not even learn of the existence of the group, its lifetime, and/or members. The group updates are updated to the group address and encrypted using the group key, and thus readable only to group members.</p>

<h2 id="group-messaging">Group messaging</h2>
<p>Any member of the group can send message to the group address. This message is encrypted using the group key.</p>

<h2 id="participant-list-change">Participant list change</h2>
<p>Whenever admin adds new group member(s), he updates the group key and sends invite to these new members. Updating the group key prevents new members to be able to read old messages.
Whenever admin removes participants from the group, new group address and group key has to be generated. The new group key is encrypted in the way that only remaining participants can read it.</p>

<h2 id="group-disband">Group disband</h2>
<p>Admin can discontinue the group by disbanding it. No new messages, updates or messages, can be sent to the group anymore.</p>

<h2 id="receiving-group-messages">Receiving group messages</h2>
<p>Group participants can read the new group messages only if they know the actual group name (group address) and group key. To keep track, the group updates needs to be monitored and group parameters updated accordingly.</p>

<h1 id="message-format">Message format</h1>
<p>There are three basic types of messages:</p>
<ul>
  <li>Group invites</li>
  <li>Group updates</li>
  <li>Group message</li>
</ul>

<p>First two are so called system message. They don’t carry the actual communication between participants, just the various group parameters. The last one, group message, is carrying actual information between users.</p>

<h2 id="group-invite">Group invite</h2>
<p>Group invite is sent from admin to individual user. The format of the JSON payload is as follows:</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"type"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">                       </span><span class="err">//&lt;aka</span><span class="w"> </span><span class="s2">"system message"</span><span class="w">
  </span><span class="s2">"operation_data"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"version"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">                  </span><span class="err">//&lt;always</span><span class="w"> </span><span class="mi">1</span><span class="w">
    </span><span class="s2">"type"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"add"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"new_group_name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;NEW GROUP NAME&gt;"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"description"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;A SHORT DESCRIPTION OF THE PURPOSE OF THE GROUP&gt;"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"user_list"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"&lt;OPTIONAL LIST OF OTHER PARTICIPANTS&gt;"</span><span class="p">],</span><span class="w">
    </span><span class="s2">"senders_pubkey"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;ADMIN PUBLIC MEMO KEY&gt;"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"new_key"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[[</span><span class="s2">"&lt;RECIPIENT PUBLIC MEMO KEY&gt;"</span><span class="p">,</span><span class="w"> </span><span class="s2">"&lt;GROUP KEY ENCRYPTED WITH SENDER-RECIPIENT SHARED SECRET&gt;"</span><span class="p">]]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>
<p>NOTE: Public memo keys are stored in the structure for references. In case one of the participants changes her memo key, one can easily find which key was used in construction of the shared secret.</p>

<p>This payload is then encrypted using sender-recipient shared secret, and packed into a JSON wrapper:</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"sender"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;ADMIN PUBLIC MEMO KEY&gt;"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"recipient"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;RECIPIENT PUBLIC MEMO KEY&gt;"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"data"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;HEX ENCODED BYTE ARRAY OF THE ENCRYPTED PAYLOAD&gt;"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h2 id="group-update-1">Group update</h2>
<p>Group update is sent from admin to the actual group address. 
The format of the JSON payload is as follows:</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"type"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">                       </span><span class="err">//&lt;aka</span><span class="w"> </span><span class="s2">"system message"</span><span class="w">
  </span><span class="s2">"operation_data"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"version"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">                  </span><span class="err">//&lt;always</span><span class="w"> </span><span class="mi">1</span><span class="w">
    </span><span class="s2">"type"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"update"</span><span class="p">,</span><span class="w">             
    </span><span class="s2">"new_group_name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;NEW GROUP NAME&gt;"</span><span class="p">,</span><span class="w"> </span><span class="err">//optional</span><span class="w"> </span><span class="err">parameter</span><span class="p">,</span><span class="w"> </span><span class="err">in</span><span class="w"> </span><span class="err">case</span><span class="w"> </span><span class="err">group</span><span class="w"> </span><span class="err">name</span><span class="w"> </span><span class="err">changes.</span><span class="w"> </span><span class="err">Can</span><span class="w"> </span><span class="err">be</span><span class="w"> </span><span class="err">omitted.</span><span class="w">
    </span><span class="s2">"description"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;A SHORT DESCRIPTION OF THE PURPOSE OF THE GROUP&gt;"</span><span class="p">,</span><span class="w"> </span><span class="err">//optional</span><span class="w"> </span><span class="err">parameter</span><span class="p">,</span><span class="w"> </span><span class="err">in</span><span class="w"> </span><span class="err">case</span><span class="w"> </span><span class="err">group</span><span class="w"> </span><span class="err">description</span><span class="w"> </span><span class="err">changes.</span><span class="w"> </span><span class="err">Can</span><span class="w"> </span><span class="err">be</span><span class="w"> </span><span class="err">omitted.</span><span class="w">
    </span><span class="s2">"user_list"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"&lt;OPTIONAL LIST OF OTHER PARTICIPANTS&gt;"</span><span class="p">],</span><span class="w">
    </span><span class="s2">"senders_pubkey"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;ADMIN PUBLIC MEMO KEY&gt;"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"new_key"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[[</span><span class="s2">"SEE BELOW"</span><span class="p">]]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Would the group key change, the new key is encoded either with group key or with shared secrets for each individual group participant. The later must be used in case of deleting participants. 
The first case has then the following format:</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s2">"new_key"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[[</span><span class="s2">"SPH1111111111111111111111111111111114T1Anm"</span><span class="p">,</span><span class="w"> </span><span class="s2">"&lt;ENCRYPTED_GROUP_KEY&gt;"</span><span class="p">]]</span><span class="w">
</span></code></pre></div></div>

<p>The second case will end in a list of encrypted keys:</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s2">"new_key"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">[</span><span class="s2">"&lt;RECIPIENT1 PUBLIC MEMO KEY&gt;"</span><span class="p">,</span><span class="w"> </span><span class="s2">"&lt;GROUP KEY ENCRYPTED WITH SENDER-RECIPIENT1 SHARED SECRET&gt;"</span><span class="p">],</span><span class="w">
    </span><span class="p">[</span><span class="s2">"&lt;RECIPIENT2 PUBLIC MEMO KEY&gt;"</span><span class="p">,</span><span class="w"> </span><span class="s2">"&lt;GROUP KEY ENCRYPTED WITH SENDER-RECIPIENT2 SHARED SECRET&gt;"</span><span class="p">],</span><span class="w">
</span><span class="err">(...)</span><span class="w">
    </span><span class="p">[</span><span class="s2">"&lt;RECIPIENT_N PUBLIC MEMO KEY&gt;"</span><span class="p">,</span><span class="w"> </span><span class="s2">"&lt;GROUP KEY ENCRYPTED WITH SENDER-RECIPIENT_N SHARED SECRET&gt;"</span><span class="p">]</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div></div>

<p>This payload is then encrypted using group key, and packed into a JSON wrapper:</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"iv"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;INITIAL VECTOR FOR AES&gt;"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"data"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;HEX ENCODED BYTE ARRAY OF THE ENCRYPTED PAYLOAD&gt;"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h2 id="group-message">Group message</h2>
<p>Group update is sent from a group member to the actual group address.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"type"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="s2">"message_data"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;HEX ENCODED COMMUNICATION&gt;"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>This payload is then encrypted using group key, and packed into a JSON wrapper:</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"iv"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;INITIAL VECTOR FOR AES&gt;"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"data"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;HEX ENCODED BYTE ARRAY OF THE ENCRYPTED PAYLOAD&gt;"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h1 id="encryption">Encryption</h1>

<p>As a base, AES256 is used.</p>

<p>Group key is of length 256 bits. Initialisation vector of length 256 bits is randomly generated and added as a parameter to the messages where group key encryption is used.</p>

<p>Shared secret between sender and recipient is derived from sender’s private and recipient’s public keys or recipient’s private and sender’s public keys using Elliptic curve integrated encryption scheme (ECIES) over SECP256K1 curve. The resulting 512 bits are split to halfs, one half used as IV and the other as key in AES256 schema.</p>

<h1 id="api">API</h1>
<p>The multiparty messaging plugin was developed as a reference implementation. Its usability is limited to be run on end-user’s node, and the node must not expose its API to general public. The plugin is started when the following parameters are added to the daemon when starting:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>--plugin multiparty_messaging --mpm-app-id 2 --mpm-account &lt;MYACCOUNT&gt; --mpm-private-key &lt;PRIVATE_MEMO_KEY&gt;
</code></pre></div></div>
<p>NOTE: The <code class="highlighter-rouge">mpm-account</code> and <code class="highlighter-rouge">mpm-private-key</code> can be repeated more than once.</p>

<p>Once the plugin is started, it starts listening for <code class="highlighter-rouge">custom_json_operations</code> with the given application ID and executes the logic as described above. It stores in database information about all past and active groups the user has been involved in, as well as all decoded messages. 
The API calls can be split into two logical part:</p>
<ul>
  <li>Retrieving the group and messages info from the database, namely <code class="highlighter-rouge">get_group</code>, <code class="highlighter-rouge">get_group_name</code>, <code class="highlighter-rouge">list_my_groups</code> and <code class="highlighter-rouge">list_messages</code>.</li>
  <li>Preparing encrypted <code class="highlighter-rouge">custom_json_operations</code> payloads. The returned payloads has to be sent to the provided addresses either with Alexandria SDKs or cli_wallet.</li>
</ul>

<h3 id="example">Example</h3>
<p>First create the group invitation by user <code class="highlighter-rouge">initminer</code> using wscat:</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">&gt;</span><span class="w"> </span><span class="p">{</span><span class="s2">"jsonrpc"</span><span class="p">:</span><span class="s2">"2.0"</span><span class="p">,</span><span class="w"> </span><span class="s2">"id"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s2">"method"</span><span class="p">:</span><span class="s2">"multiparty_messaging.create_group"</span><span class="p">,</span><span class="w"> </span><span class="s2">"params"</span><span class="p">:{</span><span class="s2">"admin"</span><span class="p">:</span><span class="s2">"initminer"</span><span class="p">,</span><span class="w"> </span><span class="s2">"description"</span><span class="p">:</span><span class="s2">"blah"</span><span class="p">,</span><span class="w"> </span><span class="s2">"members"</span><span class="p">:[</span><span class="s2">"kpX6yHkAb_RIEuQ7g7UVoGwpUKo"</span><span class="p">]}}</span><span class="w">
</span><span class="err">&lt;</span><span class="w"> </span><span class="p">{</span><span class="s2">"jsonrpc"</span><span class="p">:</span><span class="s2">"2.0"</span><span class="p">,</span><span class="s2">"result"</span><span class="p">:{</span><span class="s2">"group_name"</span><span class="p">:</span><span class="s2">"wY8SqXZDuH3SL0Im0G5vuZOch6g"</span><span class="p">,</span><span class="s2">"operation_payloads"</span><span class="p">:[[</span><span class="s2">"kpX6yHkAb_RIEuQ7g7UVoGwpUKo"</span><span class="p">,{</span><span class="s2">"sender"</span><span class="p">:</span><span class="s2">"SPH8HWPUynRQnH8QCHdCvebNKbKGuVpZ9FZpg3EWv9UN5qayA8v7k"</span><span class="p">,</span><span class="s2">"recipient"</span><span class="p">:</span><span class="s2">"SPH7t5298LP6CDuC8SHT7PGaH7rvqCYgV6sCsrT55VLJXEuQXWnPw"</span><span class="p">,</span><span class="s2">"data"</span><span class="p">:</span><span class="s2">"396a3370a56a188403c1185b6ac98d69d01a2c42699a986da80f1d762e54671d82a9097983a228da8635d157d24c01bd9fe20ea0c1a390a6d6c7a247eea80ab3b6f4649c1dc1d3539307a36e9f525f8bab3416ccaf1bac26ee539ea0e289489a1f0261ac9a9f5a95317c3fe62bd49b3b0a5f85db3708eab406e6f181deb6a6fce851154f7ded1495befd308a33abe7002798f4a3d45adbb0c52a97175dbe14e76850d40b05d1147e4d070320051c6c46de600307e5ad59aa0290deb6368e92974a98047f96c5b70a7be005dd455c1557"</span><span class="p">}]]},</span><span class="s2">"id"</span><span class="p">:</span><span class="mi">1</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>
<p>Group name <code class="highlighter-rouge">"wY8SqXZDuH3SL0Im0G5vuZOch6g"</code> was generated, as well as one invitation.
The returned invitation payload is then sent using cli_wallet:</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">unlocked</span><span class="w"> </span><span class="err">&gt;&gt;&gt;</span><span class="w"> </span><span class="err">send_custom_json_document</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="err">initminer</span><span class="w"> </span><span class="p">[</span><span class="s2">"kpX6yHkAb_RIEuQ7g7UVoGwpUKo"</span><span class="p">]</span><span class="w"> </span><span class="s2">"{</span><span class="se">\"</span><span class="s2">sender</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">SPH8HWPUynRQnH8QCHdCvebNKbKGuVpZ9FZpg3EWv9UN5qayA8v7k</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">recipient</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">SPH7t5298LP6CDuC8SHT7PGaH7rvqCYgV6sCsrT55VLJXEuQXWnPw</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">data</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">396a3370a56a188403c1185b6ac98d69d01a2c42699a986da80f1d762e54671d82a9097983a228da8635d157d24c01bd9fe20ea0c1a390a6d6c7a247eea80ab3b6f4649c1dc1d3539307a36e9f525f8bab3416ccaf1bac26ee539ea0e289489a1f0261ac9a9f5a95317c3fe62bd49b3b0a5f85db3708eab406e6f181deb6a6fce851154f7ded1495befd308a33abe7002798f4a3d45adbb0c52a97175dbe14e76850d40b05d1147e4d070320051c6c46de600307e5ad59aa0290deb6368e92974a98047f96c5b70a7be005dd455c1557</span><span class="se">\"</span><span class="s2">}"</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="s2">"ref_block_num"</span><span class="p">:</span><span class="w"> </span><span class="mi">2417</span><span class="p">,</span><span class="w">
  </span><span class="s2">"ref_block_prefix"</span><span class="p">:</span><span class="w"> </span><span class="mi">3747953573</span><span class="p">,</span><span class="w">
  </span><span class="s2">"expiration"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-12-13T13:34:00"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"operations"</span><span class="p">:</span><span class="w"> </span><span class="p">[[</span><span class="w">
      </span><span class="s2">"custom_json"</span><span class="p">,{</span><span class="w">
        </span><span class="s2">"fee"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.000000 SPHTX"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"sender"</span><span class="p">:</span><span class="w"> </span><span class="s2">"initminer"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"recipients"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="s2">"kpX6yHkAb_RIEuQ7g7UVoGwpUKo"</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="s2">"app_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
        </span><span class="s2">"json"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{</span><span class="se">\"</span><span class="s2">sender</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">SPH8HWPUynRQnH8QCHdCvebNKbKGuVpZ9FZpg3EWv9UN5qayA8v7k</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">recipient</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">SPH7t5298LP6CDuC8SHT7PGaH7rvqCYgV6sCsrT55VLJXEuQXWnPw</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">data</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">396a3370a56a188403c1185b6ac98d69d01a2c42699a986da80f1d762e54671d82a9097983a228da8635d157d24c01bd9fe20ea0c1a390a6d6c7a247eea80ab3b6f4649c1dc1d3539307a36e9f525f8bab3416ccaf1bac26ee539ea0e289489a1f0261ac9a9f5a95317c3fe62bd49b3b0a5f85db3708eab406e6f181deb6a6fce851154f7ded1495befd308a33abe7002798f4a3d45adbb0c52a97175dbe14e76850d40b05d1147e4d070320051c6c46de600307e5ad59aa0290deb6368e92974a98047f96c5b70a7be005dd455c1557</span><span class="se">\"</span><span class="s2">}"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="s2">"extensions"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
  </span><span class="s2">"signatures"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"1f6b1c7281e2d875aed831d9f117a1c65f84c5b806dcac88f395a9635247418a104a0c69b0935dcc848be8171c288ff56b8e3e944041c3e4000d93afb3d10bf8d1"</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="s2">"transaction_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"e76c37b71a3ca23ddc044edd2224880295a0bce0"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"block_num"</span><span class="p">:</span><span class="w"> </span><span class="mi">2418</span><span class="p">,</span><span class="w">
  </span><span class="s2">"transaction_num"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="err">unlocked</span><span class="w"> </span><span class="err">&gt;&gt;&gt;</span><span class="w">
</span></code></pre></div></div>
<p>We can check success of the operation again with wscat:</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">&gt;</span><span class="w"> </span><span class="p">{</span><span class="s2">"jsonrpc"</span><span class="p">:</span><span class="s2">"2.0"</span><span class="p">,</span><span class="w"> </span><span class="s2">"id"</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="s2">"method"</span><span class="p">:</span><span class="s2">"multiparty_messaging.get_group"</span><span class="p">,</span><span class="w"> </span><span class="s2">"params"</span><span class="p">:{</span><span class="s2">"group_name"</span><span class="p">:</span><span class="s2">"wY8SqXZDuH3SL0Im0G5vuZOch6g"</span><span class="p">}}</span><span class="w">
</span><span class="err">&lt;</span><span class="w"> </span><span class="p">{</span><span class="s2">"jsonrpc"</span><span class="p">:</span><span class="s2">"2.0"</span><span class="p">,</span><span class="s2">"result"</span><span class="p">:{</span><span class="s2">"group_name"</span><span class="p">:</span><span class="s2">"wY8SqXZDuH3SL0Im0G5vuZOch6g"</span><span class="p">,</span><span class="s2">"current_group_name"</span><span class="p">:</span><span class="s2">"wY8SqXZDuH3SL0Im0G5vuZOch6g"</span><span class="p">,</span><span class="s2">"description"</span><span class="p">:</span><span class="s2">"blah"</span><span class="p">,</span><span class="s2">"members"</span><span class="p">:[</span><span class="s2">"kpX6yHkAb_RIEuQ7g7UVoGwpUKo"</span><span class="p">,</span><span class="s2">"initminer"</span><span class="p">],</span><span class="s2">"admin"</span><span class="p">:</span><span class="s2">"initminer"</span><span class="p">,</span><span class="s2">"group_key"</span><span class="p">:</span><span class="s2">"b019a8e962d111b020f0fd0181f3e59e6f7727076fce2486bc28cf8c0270a589"</span><span class="p">,</span><span class="s2">"messages"</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span><span class="s2">"id"</span><span class="p">:</span><span class="mi">2</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>


		</section>
	
		<section id="tutorials-subscription-api-quick-guide" class="row tutorials-subscription-api-quick-guide">
			<h3>
				<a id="tutorials-subscription-api-quick-guide">
					Subscription API guide
					
				</a>
			</h3>
			

			<h1 id="subscription-api-quick-guide">Subscription API quick guide</h1>
<p>Subscription API is accessible as one of the daemon APIs. In order to work, it has to be enabled, as well as dependant APIs with params</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>--plugin custom_api --plugin subscribe_api
</code></pre></div></div>

<p>Once it is enabled, WebSocket subscriptions can be used. The only call supported now is <code class="highlighter-rouge">custom_object_subscription</code>. Example of usage is:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>wscat  --connect 127.0.0.1:8095
connected (press CTRL+C to quit)
&gt; {"jsonrpc": "2.0", "method": "subscribe_api.custom_object_subscription", "params":{"return_id":22, "app_id":1, "account_name":"initminer", "search_type":"by_sender", "start":1},  "id": 1}
&lt; {"jsonrpc":"2.0","result":1,"id":1}
(now the messages comes)
&lt; {"method":"notice","params":[22,[2,{"id":3,"sender":"initminer","recipients":["initminer"],"app_id":1,"data":"{}","received":"2018-08-23T11:55:12","binary":false}]]}
</code></pre></div></div>

		</section>
	
		<section id="tutorials-using-sophiatx-to-send-hello-world-msg-via-api" class="row tutorials-using-sophiatx-to-send-hello-world-msg-via-api">
			<h3>
				<a id="tutorials-using-sophiatx-to-send-hello-world-msg-via-api">
					Hello World via API calls
					
				</a>
			</h3>
			

			<h1 id="hello-world-example">Hello World example</h1>
<p>This is just simple example of sending Hello World message proper way in our blockchain via public API.</p>

<h2 id="creating-custom-json-operation">Creating custom json operation</h2>
<p>To send Hello World via our API function to our blockchain, you need to fill this JSON structure.
JSON struct:</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="w">
  </span><span class="s2">"custom_json"</span><span class="p">,{</span><span class="w">
    </span><span class="s2">"sender"</span><span class="p">:</span><span class="w"> </span><span class="s2">"USERNAME"</span><span class="p">,</span><span class="w"> </span><span class="err">//actual</span><span class="w"> </span><span class="err">user</span><span class="w"> </span><span class="err">account</span><span class="w"> </span><span class="err">on</span><span class="w"> </span><span class="err">blockchain</span><span class="p">,</span><span class="w"> </span><span class="err">that</span><span class="w"> </span><span class="err">will</span><span class="w"> </span><span class="err">sign</span><span class="w"> </span><span class="err">this</span><span class="w"> </span><span class="err">transaction</span><span class="w">
    </span><span class="s2">"recipients"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="err">//array</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">recipients</span><span class="p">,</span><span class="w"> </span><span class="err">does</span><span class="w"> </span><span class="err">not</span><span class="w"> </span><span class="err">to</span><span class="w"> </span><span class="err">be</span><span class="w"> </span><span class="err">actuall</span><span class="w"> </span><span class="err">account</span><span class="w"> </span><span class="err">on</span><span class="w"> </span><span class="err">blockchain</span><span class="p">,</span><span class="w"> </span><span class="err">but</span><span class="w"> </span><span class="err">you</span><span class="w"> </span><span class="err">are</span><span class="w"> </span><span class="err">free</span><span class="w"> </span><span class="err">to</span><span class="w"> </span><span class="err">used</span><span class="w"> </span><span class="err">for</span><span class="w"> </span><span class="err">your</span><span class="w"> </span><span class="err">app</span><span class="w"> </span><span class="err">logic</span><span class="w">
      </span><span class="s2">"MSG_BOX"</span><span class="w"> 
    </span><span class="p">],</span><span class="w">
    </span><span class="s2">"app_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">777</span><span class="p">,</span><span class="w"> </span><span class="err">//App</span><span class="w"> </span><span class="err">id</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">your</span><span class="w"> </span><span class="err">app</span><span class="w">
    </span><span class="s2">"json"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{</span><span class="se">\"</span><span class="s2">Hello World</span><span class="se">\"</span><span class="s2">}"</span><span class="w"> </span><span class="err">//escaped</span><span class="w"> </span><span class="err">msg</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div></div>
<p>Then you can use this curl commnad to send it to blockchain.
private_key is private key of USERNAME</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">curl</span><span class="w"> </span><span class="err">-v</span><span class="w"> </span><span class="err">-s</span><span class="w"> </span><span class="err">--data</span><span class="w"> </span><span class="err">'</span><span class="p">{</span><span class="s2">"id"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s2">"jsonrpc"</span><span class="p">:</span><span class="s2">"2.0"</span><span class="p">,</span><span class="s2">"method"</span><span class="p">:</span><span class="s2">"alexandria_api.send_and_sign_operation"</span><span class="p">,</span><span class="w"> </span><span class="s2">"params"</span><span class="p">:{</span><span class="s2">"op"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"custom_json"</span><span class="p">,{</span><span class="s2">"sender"</span><span class="p">:</span><span class="w"> </span><span class="s2">"USERNAME"</span><span class="p">,</span><span class="w"> </span><span class="s2">"recipients"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"MSG_BOX"</span><span class="w"> </span><span class="p">],</span><span class="s2">"app_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">777</span><span class="p">,</span><span class="w"> </span><span class="s2">"json"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{ </span><span class="se">\"</span><span class="s2">msg</span><span class="se">\"</span><span class="s2"> : </span><span class="se">\"</span><span class="s2">Hello World</span><span class="se">\"</span><span class="s2">}"</span><span class="p">}],</span><span class="w"> </span><span class="s2">"pk"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="err">private_key</span><span class="p">}}</span><span class="err">'</span><span class="w"> </span><span class="err">https</span><span class="p">:</span><span class="err">//API_URL</span><span class="w">
</span></code></pre></div></div>
<p>resposne</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="s2">"jsonrpc"</span><span class="p">:</span><span class="s2">"2.0"</span><span class="p">,</span><span class="s2">"result"</span><span class="p">:{</span><span class="s2">"signed_tx"</span><span class="p">:{</span><span class="s2">"ref_block_num"</span><span class="p">:</span><span class="mi">15641</span><span class="p">,</span><span class="s2">"ref_block_prefix"</span><span class="p">:</span><span class="mi">973882209</span><span class="p">,</span><span class="s2">"expiration"</span><span class="p">:</span><span class="s2">"2019-04-04T12:39:12"</span><span class="p">,</span><span class="s2">"operations"</span><span class="p">:[[</span><span class="s2">"custom_json"</span><span class="p">,{</span><span class="s2">"fee"</span><span class="p">:</span><span class="s2">"0.010000 SPHTX"</span><span class="p">,</span><span class="s2">"sender"</span><span class="p">:</span><span class="s2">"user1"</span><span class="p">,</span><span class="s2">"recipients"</span><span class="p">:[</span><span class="s2">"MSG_BOX"</span><span class="p">],</span><span class="s2">"app_id"</span><span class="p">:</span><span class="mi">777</span><span class="p">,</span><span class="s2">"json"</span><span class="p">:</span><span class="s2">"{ </span><span class="se">\"</span><span class="s2">msg</span><span class="se">\"</span><span class="s2"> :</span><span class="se">\"</span><span class="s2">Hello World</span><span class="se">\"</span><span class="s2">}"</span><span class="p">}]],</span><span class="s2">"extensions"</span><span class="p">:[],</span><span class="s2">"signatures"</span><span class="p">:[</span><span class="s2">"20044265aecd561bd3cf05bae0eab195698a16f5cba8eb8f69e930b4992be0144558437db2503fbbec748c29c8a667d44399e38d75e215138d1eb2ccd10c8f73f7"</span><span class="p">],</span><span class="s2">"transaction_id"</span><span class="p">:</span><span class="s2">"418cf08ac9192aa309c31357d3caf0d3bc214362"</span><span class="p">,</span><span class="s2">"block_num"</span><span class="p">:</span><span class="mi">81178</span><span class="p">,</span><span class="s2">"transaction_num"</span><span class="p">:</span><span class="mi">0</span><span class="p">}},</span><span class="s2">"id"</span><span class="p">:</span><span class="mi">0</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h3 id="checking-message">Checking message</h3>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">curl</span><span class="w"> </span><span class="err">-v</span><span class="w"> </span><span class="err">-s</span><span class="w"> </span><span class="err">--data</span><span class="w"> </span><span class="err">'</span><span class="p">{</span><span class="s2">"id"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s2">"jsonrpc"</span><span class="p">:</span><span class="s2">"2.0"</span><span class="p">,</span><span class="s2">"method"</span><span class="p">:</span><span class="s2">"alexandria_api.get_received_documents"</span><span class="p">,</span><span class="w"> </span><span class="s2">"params"</span><span class="p">:{</span><span class="w"> </span><span class="s2">"app_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">777</span><span class="p">,</span><span class="w"> </span><span class="s2">"account_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"USERNAME"</span><span class="p">,</span><span class="w"> </span><span class="s2">"search_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"by_sender_reverse"</span><span class="p">,</span><span class="w"> </span><span class="s2">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"count"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">}}</span><span class="err">'</span><span class="w"> </span><span class="err">https</span><span class="p">:</span><span class="err">//API_URL</span><span class="w">
</span></code></pre></div></div>

<p>response:</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="s2">"jsonrpc"</span><span class="p">:</span><span class="s2">"2.0"</span><span class="p">,</span><span class="s2">"result"</span><span class="p">:{</span><span class="s2">"received_documents"</span><span class="p">:[[</span><span class="mi">1</span><span class="p">,{</span><span class="s2">"id"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s2">"sender"</span><span class="p">:</span><span class="s2">"user1"</span><span class="p">,</span><span class="s2">"recipients"</span><span class="p">:[</span><span class="s2">"MSG_BOX"</span><span class="p">],</span><span class="s2">"app_id"</span><span class="p">:</span><span class="mi">777</span><span class="p">,</span><span class="s2">"data"</span><span class="p">:</span><span class="s2">"{ </span><span class="se">\"</span><span class="s2">msg</span><span class="se">\"</span><span class="s2"> :</span><span class="se">\"</span><span class="s2">Hello World</span><span class="se">\"</span><span class="s2">}"</span><span class="p">,</span><span class="s2">"received"</span><span class="p">:</span><span class="s2">"2019-04-04T12:38:42"</span><span class="p">,</span><span class="s2">"binary"</span><span class="p">:</span><span class="kc">false</span><span class="p">}]]},</span><span class="s2">"id"</span><span class="p">:</span><span class="mi">0</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>


		</section>
	
		<section id="tutorials-using-sophiatx-to-send-hello-world-msg" class="row tutorials-using-sophiatx-to-send-hello-world-msg">
			<h3>
				<a id="tutorials-using-sophiatx-to-send-hello-world-msg">
					Hello World on SophiaTX
					
				</a>
			</h3>
			

			<h1 id="hello-world-example">Hello World example</h1>
<p>This is just simple example of sending Hello World message proper way in our blockchain with help of our alexandria_deamon</p>
<h2 id="creating-account">Creating account</h2>
<p>First step is to create second account (recipient of message). For this step you need to have one account already created, if not please use our wallet.</p>
<h3 id="generating-keys">Generating keys</h3>
<p>New account requires new pair of keys, we use 3 different key_pairs in our blockchain, but for this simple example I will same key for all 3 different keys. So to generate key pair you need to execute this command</p>

<p><code class="highlighter-rouge">&gt;&gt;&gt;generate_key_pair</code></p>

<p>response:</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"pub_key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SPH667jA4gwFxRkSpKFAyWTDbzydRF1JPQrDc4ReqtpeujwvVUDfQ"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"wif_priv_key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5KdvUxpR2NTdQHV91qT9K7g8oHvNz6F6vyhnGDUNUC1KYpaYH9r"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>
<h3 id="creating-account-1">Creating account</h3>
<p>So now, when the key pair is ready I can create create_account operation</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>create_account registered_account test_account "{}" SPH667jA4gwFxRkSpKFAyWTDbzydRF1JPQrDc4ReqtpeujwvVUDfQ SPH667jA4gwFxRkSpKFAyWTDbzydRF1JPQrDc4ReqtpeujwvVUDfQ SPH667jA4gwFxRkSpKFAyWTDbzydRF1JPQrDc4ReqtpeujwvVUDfQ
</code></pre></div></div>
<p>response:</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="w">
  </span><span class="s2">"account_create"</span><span class="p">,{</span><span class="w">
    </span><span class="s2">"fee"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.100000 SPHTX"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"creator"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4PMRaUBMJmL89eWcb1XrpL7DFGhJ"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"name_seed"</span><span class="p">:</span><span class="w"> </span><span class="s2">"test_account"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"owner"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"weight_threshold"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="s2">"account_auths"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
      </span><span class="s2">"key_auths"</span><span class="p">:</span><span class="w"> </span><span class="p">[[</span><span class="w">
          </span><span class="s2">"SPH667jA4gwFxRkSpKFAyWTDbzydRF1JPQrDc4ReqtpeujwvVUDfQ"</span><span class="p">,</span><span class="w">
          </span><span class="mi">1</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"active"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"weight_threshold"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="s2">"account_auths"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
      </span><span class="s2">"key_auths"</span><span class="p">:</span><span class="w"> </span><span class="p">[[</span><span class="w">
          </span><span class="s2">"SPH667jA4gwFxRkSpKFAyWTDbzydRF1JPQrDc4ReqtpeujwvVUDfQ"</span><span class="p">,</span><span class="w">
          </span><span class="mi">1</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"memo_key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SPH667jA4gwFxRkSpKFAyWTDbzydRF1JPQrDc4ReqtpeujwvVUDfQ"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"json_metadata"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{}"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div></div>
<h3 id="signing-and-broadcasting-transaction">Signing and broadcasting transaction</h3>
<p>Now when operation is ready, we need to create transaction from it, sign it and broadcast to blockchain node. It is possible to use specific function for each of these steps, but there is one function that will do everything for us, but do not use this function on network, because it will expose your private key!</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&gt;&gt;&gt;send_and_sign_operation operation_from_last_step registered_account_private_key
</code></pre></div></div>
<h3 id="checking-if-account-was-created">Checking if account was created</h3>
<p>Now we should check if account was successfully created and for that we can use function:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&gt;&gt;&gt;get_account test_account
</code></pre></div></div>
<p>response:</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
  </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4PMRaUBMJmL89eWcb1XrpL7DFGhJ"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"owner"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"weight_threshold"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="s2">"account_auths"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
    </span><span class="s2">"key_auths"</span><span class="p">:</span><span class="w"> </span><span class="p">[[</span><span class="w">
        </span><span class="s2">"SPH667jA4gwFxRkSpKFAyWTDbzydRF1JPQrDc4ReqtpeujwvVUDfQ"</span><span class="p">,</span><span class="w">
        </span><span class="mi">1</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"active"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"weight_threshold"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="s2">"account_auths"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
    </span><span class="s2">"key_auths"</span><span class="p">:</span><span class="w"> </span><span class="p">[[</span><span class="w">
        </span><span class="s2">"SPH667jA4gwFxRkSpKFAyWTDbzydRF1JPQrDc4ReqtpeujwvVUDfQ"</span><span class="p">,</span><span class="w">
        </span><span class="mi">1</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"memo_key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SPH667jA4gwFxRkSpKFAyWTDbzydRF1JPQrDc4ReqtpeujwvVUDfQ"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"json_metadata"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
  </span><span class="s2">"voting_proxy"</span><span class="p">:</span><span class="w"> </span><span class="s2">"11111111111111111111"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"balance"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.000000 SPHTX"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"vesting_shares"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.000000 VESTS"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"vesting_withdraw_rate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.000000 VESTS"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"to_withdraw"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="s2">"witness_votes"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
  </span><span class="s2">"sponsored_accounts"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
  </span><span class="s2">"sponsoring_account"</span><span class="p">:</span><span class="w"> </span><span class="s2">"11111111111111111111"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>
<h2 id="creating-application">Creating application</h2>
<p>Next step is to create application, that we will use for sending custom document</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&gt;&gt;&gt;create_application 4PMRaUBMJmL89eWcb1XrpL7DFGhJ TESTAPP "www.sophiatx.com" "" 0
</code></pre></div></div>

<p>result:</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="w">
  </span><span class="s2">"application_create"</span><span class="p">,{</span><span class="w">
    </span><span class="s2">"fee"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.000000 SPHTX"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"author"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4PMRaUBMJmL89eWcb1XrpL7DFGhJ"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"TESTAPP"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"www.sophiatx.com"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="s2">"price_param"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div></div>
<p>Now you need to sign and broadcast it as in create account.</p>
<h3 id="checking-if-account-was-created-1">Checking if account was created</h3>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&gt;&gt;&gt;get_applications ["TESTAPP"]
</code></pre></div></div>
<p>result:</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"TESTAPP"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"author"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4PMRaUBMJmL89eWcb1XrpL7DFGhJ"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"www.sophiatx.com"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="s2">"price_param"</span><span class="p">:</span><span class="w"> </span><span class="s2">"permanent"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div></div>
<h2 id="creating-custom-json-operation">Creating custom json operation</h2>
<p>Now the final step sending message Hello world. For that we will use make_custom_json_operation.</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make_custom_json_operation 1 GN3Ug8ou6tiE4kWvyopJBJmZgcw ["4PMRaUBMJmL89eWcb1XrpL7DFGhJ"] "{\"Hello World\"}"
</code></pre></div></div>
<p>result:</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="w">
  </span><span class="s2">"custom_json"</span><span class="p">,{</span><span class="w">
    </span><span class="s2">"fee"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.000000 SPHTX"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"sender"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GN3Ug8ou6tiE4kWvyopJBJmZgcw"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"recipients"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"4PMRaUBMJmL89eWcb1XrpL7DFGhJ"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="s2">"app_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="s2">"json"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{</span><span class="se">\"</span><span class="s2">Hello World</span><span class="se">\"</span><span class="s2">}"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div></div>
<p>Now we need to sign and send it</p>
<h3 id="checking-message">Checking message</h3>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>get_received_documents 1 GN3Ug8ou6tiE4kWvyopJBJmZgcw "by_sender" 10 1
</code></pre></div></div>

<p>result:</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[[</span><span class="w">
    </span><span class="mi">1</span><span class="p">,{</span><span class="w">
      </span><span class="s2">"sender"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GN3Ug8ou6tiE4kWvyopJBJmZgcw"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"recipients"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"4PMRaUBMJmL89eWcb1XrpL7DFGhJ"</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="s2">"app_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{</span><span class="se">\"</span><span class="s2">Hello World</span><span class="se">\"</span><span class="s2">}"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"received"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-07-10T11:37:42"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"binary"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div></div>


		</section>
	
		<section id="tutorials-guide-automatic-deploy" class="row tutorials-guide-automatic-deploy">
			<h3>
				<a id="tutorials-guide-automatic-deploy">
					Node Deploy script
					
				</a>
			</h3>
			

			<h1 id="automatic-node-deploy">Automatic node deploy</h1>

<p><a href="https://github.com/SophiaTX/SophiaTX/tree/develop/ciscripts/deploy">Deploy Script</a> connects to the server and automatically deploys node binaries and stores previous version</p>

<p>Created file structure on server:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> ~                                          # home of specified user
 ├── ...                        
 ├── sophiatx_binaries                      # Binaries folder
 │   ├── sophiatx_#&lt;NUM&gt;.tar.gz             # SophiaTX archived binaries
 │   ├── sophiatx_#&lt;NUM&gt;.tar.gz.old         # Previous version of SophiaTX archived binaries
 │   ├── sophiatxd                          # SophiaTX demon
 │   └── sophia_app_data                    # Master data folder
 │       ├── configs                        # Configs data folder
 │       │   ├── testnet_config.ini         # SophiaTX demon config file
 │       │   ├── testnet_config.ini.old     # Previous version of SophiaTX demon config file
 │       │   └── ...
 │       └── ...
 └── ... 
</code></pre></div></div>

<h2 id="usage">Usage</h2>

<p>./deploy-node.sh -h host -u user [-s sourceUrl] [-r]</p>

<h4 id="arguments-description">Arguments description:</h4>

<p>-h host         : host(server), where node binaries should be deployed into</p>

<p>-u user         : user to be used to connect to the host. This user has to have id_rsa.pub imported on host</p>

<p>[-s sourceUrl]  : sourceUrl from which are the the binaries downloaded. optional. In case it is not specified, latest binaries(devnet) are downloaded.</p>

<p>[-r]            : replay-blockain flag. It is used when starting sophiatxd. optional</p>

<h2 id="requirements">Requirements</h2>

<p>For using automatic deploy script, you have to install Ansible on your machine:</p>

<p>$ sudo apt-get update <br />
$ sudo apt-get install software-properties-common <br />
$ sudo apt-add-repository ppa:ansible/ansible <br />
$ sudo apt-get update <br />
$ sudo apt-get install ansible**</p>

		</section>
	
		<section id="tutorials-guide-custom-plugins" class="row tutorials-guide-custom-plugins">
			<h3>
				<a id="tutorials-guide-custom-plugins">
					Custom plugins
					
				</a>
			</h3>
			

			<h2 id="external-plugins">External Plugins</h2>

<p>External/runtime-loadable plugins provide a way for building custom applications with advanced functionality 
on top of blockchain core functionality.</p>

<h2 id="key-features">Key Features</h2>

<ul>
  <li>Dynamically specify external plugins to load</li>
  <li>Plugins are developed as standalone shared libraries</li>
  <li>Automatically load dependent plugins in order</li>
  <li>Plugins can specify commandline arguments and configuration file options</li>
  <li>Separate configuration files for each plugin</li>
</ul>

<h2 id="standard-plugins-vs-external-plugins">Standard plugins vs External plugins</h2>

<ul>
  <li>Standard plugins are static libraries(.a), external plugins must be shared libraries(.so) + their names must 
contain suffix “_plugin”:</li>
</ul>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>add_library( track_and_trace_plugin SHARED
             source files...
           )
</code></pre></div></div>
<ul>
  <li>They both share the same interface(<code class="highlighter-rouge">plugin&lt;T&gt;, which is derived from abstract_plugin</code>), but external plugins must provide dll import interface on top of that. Format:</li>
</ul>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>extern "C" BOOST_SYMBOL_EXPORT std::shared_ptr&lt;abstract_plugin&gt; get_plugin() {
   return std::make_shared&lt;track_and_trace_plugin&gt;();
}
</code></pre></div></div>

<h2 id="configuration">Configuration</h2>
<p>In main configuration file are two parameters, which define list of external plugins:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Directory containing external/runtime-loadable plugins binaries (absolute path or relative to the data-dir/)
external-plugins-dir = "external-plugins"

# External plugin(s) to enable, may be specified multiple times
external_plugin = track_and_trace
</code></pre></div></div>
<p>“external_plugin” parameter contains only plugin name. Binary file of such plugin must be stored in directory specified by “external-plugins-dir” parameter
under following naming convetion:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lib&lt;plugin name&gt;_plugin.so -&gt; example: "libtrack_and_trace_plugin.so"
</code></pre></div></div>

<p>Plugin-specific parameters are stored in separate configuration file in subdirectory “configs” 
of “data-dir” parameter under naming convention:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;plugin name&gt;_plugin_config.ini -&gt; example: "track_and_trace_plugin_config.ini"
</code></pre></div></div>

<h3 id="example-of-data-dir-directory-structure-with-external-plugin">Example of data-dir directory structure with external plugin:</h3>
<p>Lets say program parameter “data-dir” is set to default value: “sophia_app_data”. This is how directory structure would look like:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> sophiatx-binaries                                  # directory with sophiaTX binaries
 ├── sophiatxd                                      # SophiaTX demon
 ├── sophia_app_data                                # data-dir
 │   ├── external-plugins                           # external plugins binaries directory
 │   │   ├── libtrack_and_trace_plugin.so
 │   │   └── ...  
 │   ├── configs                                    # configuration files directory
 │   │   ├── config.ini                             # main config
 │   │   ├── track_and_trace_plugin_config.ini      # track_and_trace plugin config
 │   │   └── ...
 │   ├── blockchain                                 # blockchain directory
 │   │   └── ... 
 │   ├── logs                                       # logs directory
 │   │   └── ...
 │   └── p2p                                        # p2p directory
 │       └── ...  
 └── ...      
</code></pre></div></div>

<h2 id="code-samples">Code samples:</h2>

<p>External Plugin code template is the same as for standard plugins with two minor differencies 
mentioned in “Standard plugins vs External plugins” section. Standard plugin template can be found <a href="https://github.com/SophiaTX/SophiaTX/tree/develop/libraries/plugins/template_plugin">here</a>.</p>

<p>Example of concrete implementation of external plugin (track_and_trace) can be found <a href="https://github.com/SophiaTX/SophiaTX/tree/develop/external_plugins/track_and_trace">here</a>.</p>

<h2 id="build-instructions">Build instructions:</h2>
<p>External plugin as well as all libraries that are linked must be build with -DBUILD_PIC flag to enable <a href="https://en.wikipedia.org/wiki/Position-independent_code">Position Independent Code</a>.</p>

		</section>
	


</div>
<div class="footer">
    <a href="#">↑ Back to top</a>
</div>
<script>
    document.getElementById("open-nav").addEventListener("click", function () {
        document.body.classList.toggle("nav-open");
    });
</script>
</body>
</html>

<script src="/js/adjust.js"></script>
